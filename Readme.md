# Telegram Бот: Переводчик, Хранитель Фото и Регистратор Студентов

## О проекте

Этот проект представляет собой Telegram-бота, разработанного для демонстрации различных возможностей работы с Telegram Bot API с использованием библиотеки `aiogram 3.x`. Бот умеет обрабатывать команды, текстовые сообщения, фотографии, а также вести диалог с пользователем для сбора данных с использованием механизма состояний (FSM) и сохранять их в базу данных SQLite. Проект основан на материалах "Урока TG02" и расширен дополнительным функционалом.

## Функционал

Бот реализует следующий функционал:

*   **Обработка команд:** Реализованы стандартные команды `/start`, `/help`.
*   **Регистрация студентов:**
    *   По команде `/register` бот инициирует диалог для сбора данных о студенте (имя, возраст, класс).
    *   Собранные данные сохраняются в локальную базу данных SQLite (`school_data.db` в папке `bot/db/`).
    *   Команда `/cancel` позволяет прервать процесс регистрации на любом этапе.
*   **Сохранение фотографий:** Автоматически скачивает и сохраняет любую отправленную пользователем фотографию в локальную папку `bot/assets/img/`.
*   **Отправка голосовых сообщений:** По команде `/sendvoice` отправляет пользователю заранее подготовленное тестовое голосовое сообщение (`.ogg` файл).
*   **Перевод текста:** Любое текстовое сообщение, не являющееся командой и не относящееся к активному диалогу (например, регистрации), переводится на английский язык с помощью библиотеки `googletrans` и отправляется пользователю в ответ.

## Необходимые условия

Для запуска бота у вас должны быть установлены:

*   Python 3.8 или выше
*   pip (менеджер пакетов Python)
*   Активный аккаунт Telegram
*   Токен вашего Telegram-бота (получается через @BotFather)

## Установка

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL_ВАШЕГО_РЕПОЗИТОРИЯ>
    cd telegram_translator_bot 
    ```
    *(Замените `telegram_translator_bot` на актуальное имя вашей корневой папки, если оно другое)*

2.  **Создайте виртуальное окружение (рекомендуется):**
    ```bash
    python -m venv .venv
    ```

3.  **Активируйте виртуальное окружение:**

    *   **Для Windows:**
        ```bash
        .venv\Scripts\activate
        ```
    *   **Для macOS и Linux:**
        ```bash
        source .venv/bin/activate
        ```

4.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```
    *(Убедитесь, что `aiosqlite` добавлен в ваш `requirements.txt`)*

## Настройка

### Получите токен бота

Если у вас еще нет токена, создайте нового бота или получите токен существующего через [@BotFather](https://t.me/BotFather).

### Создайте файл `.env`

В корневой директории проекта (рядом с папкой `bot/` и файлом `requirements.txt`) создайте файл с именем `.env`. Вы можете скопировать содержимое из `.env_example`.

### Добавьте токен в `.env`

Откройте файл `.env` и добавьте следующую строку:

```env
TELEGRAM_BOT_TOKEN="YOUR_BOT_TOKEN"
```

Замените `"YOUR_BOT_TOKEN"` на токен, полученный от @BotFather. **Важно: Не добавляйте файл `.env` в Git.** Он уже добавлен в `.gitignore` в этом проекте.

## Запуск бота

Убедитесь, что виртуальное окружение активно и вы находитесь в корневой директории проекта.

Запустите бота с помощью команды:

```bash
python -m bot.main
```
Бот начнет работу и будет ожидать входящих сообщений. Вы можете остановить бота, нажав Ctrl+C в терминале. При первом запуске будет автоматически создана база данных `school_data.db` (если она еще не существует).

## Структура проекта

*   `bot/`: Основная папка, содержащая код бота.
    *   `main.py`: Точка входа, инициализирует бота, диспетчер и базу данных.
    *   `config.py`: Читает токен, определяет пути к файлам и папкам, включая путь к БД.
    *   `handlers/user_handlers.py`: Обработчики для команд пользователя, сообщений, фотографий и состояний FSM для регистрации.
    *   `db/database.py`: Функции для инициализации базы данных и добавления записей студентов.
    *   `assets/`: Папка для статических файлов.
        *   `audio/`: Для аудиофайлов (например, `sample.ogg`).
        *   `img/`: Для сохранения загруженных пользователем фотографий.
    *   `db/`: Папка для файла базы данных.
        *   `school_data.db`: Файл базы данных SQLite (создается автоматически).
*   `.env`: Файл с переменными окружения (токен бота).
*   `.env_example`: Пример файла `.env`.
*   `.gitignore`: Список файлов и папок, игнорируемых Git.
*   `requirements.txt`: Список необходимых Python-библиотек.

## База данных

Бот использует базу данных SQLite, хранящуюся в файле `bot/db/school_data.db`.

### Таблица `students`
*   `id` (INTEGER, PRIMARY KEY, AUTOINCREMENT) - Уникальный идентификатор студента.
*   `name` (TEXT) - Имя студента.
*   `age` (INTEGER) - Возраст студента.
*   `grade` (TEXT) - Класс студента.

## Использование

Начните диалог с ботом в Telegram и используйте следующий функционал:

*   Отправьте `/start` или `/help`, чтобы получить информацию о боте и список команд.
*   Отправьте `/register`, чтобы начать процесс регистрации нового студента. Бот последовательно запросит имя, возраст и класс.
*   Во время процесса регистрации отправьте `/cancel`, чтобы отменить ввод данных.
*   Отправьте `/sendvoice`, чтобы получить тестовое голосовое сообщение.
*   Отправьте любое текстовое сообщение (например, "Привет мир!", "Как дела?"), и бот ответит переводом на английский (если не активен другой диалог, например, регистрация).
*   Отправьте любое изображение, и бот сохранит его на сервере (в папке `bot/assets/img/`) и сообщит об этом.

---

**Основные изменения:**

*   Обновлено название и описание проекта.
*   В "Функционал" подробно описана регистрация студентов.
*   В "Запуск бота" упомянуто автоматическое создание БД.
*   В "Структура проекта" добавлены элементы, связанные с БД (`db/database.py`, `db/school_data.db`).
*   Добавлен новый раздел "База данных" с описанием таблицы.
*   В "Использование" добавлены инструкции по командам `/register` и `/cancel`.
